---
import Layout from "../../layouts/Layout.astro";
import Meta from "../../components/Meta.astro";
import Post from "../../components/page/Post.astro";
import PageNav from "../../components/page/PageNav.astro";

import { getPosts } from "../../scripts/utils";
import Banner from "../../components/page/Banner.astro";

export async function getStaticPaths() {
  const posts = await getPosts("posts");
  return posts.map((post, i) => ({
    params: { slug: post.slug },
    props: {
      post: post,
      posts: posts,
      prev: i - 1 < 0 ? null : i - 1,
      next: i + 1 > posts.length - 1 ? null : i + 1,
    },
  }));
}

const { post, posts, prev, next } = Astro.props;
---

<Layout page="page">
  <Meta slot="meta" post={post} />
  <Banner slot="banner" post={post} />
  <Post slot="main" post={post} />
  <PageNav slot="page-nav" posts={posts} prev={prev} , next={next} />
</Layout>
